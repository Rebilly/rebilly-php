# Rebilly SDK for PHP

[![Software License][ico-license]](LICENSE)

The **Rebilly SDK for PHP** makes it easy for developers to access
[Rebilly REST APIs][link-api-doc] in their PHP code.

## Important note
This branch contains an alpha version of the Rebilly PHP SDK v3.0. It is a major breaking change which is incompatible with the previous version.

## Requirements

* PHP 8.1+.
* CURL (verify peer requires a root certificate authority -- if you have not configured php curl to use one, and your system libs aren't linked to one, you may need to do a [manual configuration](http://stackoverflow.com/questions/17478283/paypal-access-ssl-certificate-unable-to-get-local-issuer-certificate/19149687#19149687) to use the appropriate certificate authority)

## Quick Examples

Create a Rebilly Client

```php
use Rebilly\Sdk\Client;
use Rebilly\Sdk\CoreService;

// Instantiate Rebilly client.
$client = new Client([
    'base_uri' => Client::SANDBOX_HOST,
    'organizationId' => '{organizationId}',
    'apiKey' => '{secretKey}',
]);
$coreService = new CoreService(client: $client);
```

Create a Customer

```php
use Rebilly\Sdk\Exception\DataValidationException;
use Rebilly\Sdk\Model\ContactObject;
use Rebilly\Sdk\Model\Customer;

$customer = Customer::from([])
    ->setWebsiteId('{websiteId}')
    ->setPrimaryAddress(
        ContactObject::from([])
            ->setFirstName('John')
            ->setLastName('Doe'),
    );

try {
  $customer = $coreService->customers()->create($form);
} catch (DataValidationException $e) {
  var_dump($e->getValidationErrors());
}
```

For more see [examples directory](./examples/).

## Documentation

Read [Rebilly REST APIs documentation][link-api-doc] for more details.

[ico-license]: https://img.shields.io/badge/license-MIT-brightgreen.svg

[link-api-doc]: https://api-reference.rebilly.com/
[link-github]: https://github.com/Rebilly/rebilly-php

## Migration from SDK v2.x to v3.x

This new major version brings several new helper classes to communicate with Rebilly REST APIs and some incompatibilities that should be tested before switching SDK versions.

- Now, a service class can be explicitly created to make the API calls instead of using only the `Client`. The service is a helper class that encapsulates the API calls for a specific context. It means that `CoreService` is responsible for the API calls related to the [core API](https://api-reference.rebilly.com/), `UsersService` for the [users API](https://user-api-docs.rebilly.com/), and `ReportsService` for the [reports API](https://reports-api-docs.rebilly.com/). `CombinedService` can be used to make calls to any of the contexts.

- To have a similar code to the previous version, the `Client` object can be straightforwardly used to make calls to any API context. For example, instead of instantiating the service class, it can be just `$client->customers()->create($form)`.

- The namespace changed from `Rebilly\Entities` to `Rebilly\Sdk\Model`. Now, the `src` is `Rebilly\Sdk\`.

- The classes are now generated by an automation process that is triggered every time a new version of the [API definitions](https://github.com/Rebilly/api-definitions) is released. It means more frequency on the SDK updates, keeping it synced with the REST APIs.
